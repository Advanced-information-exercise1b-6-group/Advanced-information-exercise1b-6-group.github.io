(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[264],{6715:function(e,n,t){Promise.resolve().then(t.bind(t,218))},9645:function(e,n,t){"use strict";t.d(n,{P:function(){return o}});var r=t(7437),a=t(6463),i=t(2265);let l=[{label:"メニュー検索",onClick:e=>e.push("/menu/select-genre")},{label:"Home",onClick:e=>e.push("/home")},{label:"戻る",onClick:e=>e.back()}],u=[{label:"メニュー検索",onClick:e=>e.push("/menu/select-genre")},{label:"Home",onClick:e=>e.push("/home")},{label:"MyPage",onClick:e=>e.push("/mypage")}];function o(e){var n;let t=null!==(n=e.buttons)&&void 0!==n?n:e.isHome?u:l;return(0,r.jsxs)("div",{className:"flex flex-col w-full h-full",children:[(0,r.jsx)("main",{className:"flex flex-grow flex-shrink flex-col p-10 pt-14 overflow-y-scroll",children:(0,r.jsx)(i.Suspense,{children:e.children})}),0!=t.length&&(0,r.jsx)(c,{buttons:t,className:"flex-shrink-0"})]})}function c(e){let{className:n,buttons:t}=e,i=(0,a.useRouter)();return(0,r.jsx)("footer",{className:"w-full h-[20vw] bg-amber-600 flex flex-row ".concat(n),children:t.map(e=>{let{label:n,onClick:t}=e;return(0,r.jsx)("button",{className:"w-1 flex-grow h-full border-black border-2 border-l-0 first:border-l-2",onClick:()=>t(i),children:n},n)})})}},218:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return k}});var r=t(7437),a=t(6463),i=t(9645),l=t(2879),u=t(7549),o=t(2472),c=t(9825);async function s(e,n,t,r){let a=await (0,c.y)(e,n);switch(t){case"lowLipid":return a.filter(e=>{let n=!!e.breakfast&&f(e.breakfast,r.breakfast),t=!!e.lunch&&f(e.lunch,r.lunch),a=!!e.dinner&&f(e.dinner,r.dinner);return n&&t&&a});case"healthy":return a.filter(e=>{let n=!!e.breakfast&&d(e.breakfast,r.breakfast),t=!!e.lunch&&d(e.lunch,r.lunch),a=!!e.dinner&&d(e.dinner,r.dinner);return n&&t&&a});case"lowCarbon":return a.filter(e=>{let n=!!e.breakfast&&h(e.breakfast,r.breakfast),t=!!e.lunch&&h(e.lunch,r.lunch),a=!!e.dinner&&h(e.dinner,r.dinner);return n&&t&&a});default:return a}}function f(e,n){return null==n.lipid?null!=e.lipid:null!=e.lipid&&e.lipid<.99*n.lipid}function d(e,n){return f(e,n)&&h(e,n)}function h(e,n){return null==n.carbon?null!=e.carbon:null!=e.carbon&&e.carbon<.99*n.carbon}var m=t(7858),b=t(3770),g=t(2265),w=t(4887),p=t(8260);function k(){return(0,r.jsx)(i.P,{children:(0,r.jsx)(x,{})})}function x(){let e=(0,a.useRouter)(),n=(0,a.useSearchParams)(),t=(0,b.v$)(),[i,c]=(0,g.useState)(!1),f=n.get("kind");if("sweets"==f)throw Error("sweets is not supported");let d=async n=>{let r;let a=(0,u.i5)(),i=(0,m.u)(a),l=i.find(e=>"breakfast"==e.mealKind),d=i.find(e=>"lunch"==e.mealKind),h=i.find(e=>"dinner"==e.mealKind),b={breakfast:l,lunch:d,dinner:h},g=l.menu[0].genre;(0,w.flushSync)(()=>c(!0)),await (0,p.v)();try{r=await s(g,t,n,{breakfast:l.menu[0],lunch:d.menu[0],dinner:h.menu[0]})}finally{c(!1)}let k=r[Math.floor(10*Math.random())];if(null==k){alert("適切な組み合わせが見つかりませんでした");return}if(null!=f)(0,o.J)(a,f,[{...k[f],ate:!1}],b[f].additionalEnergy);else for(let e of["breakfast","lunch","dinner"])(0,o.J)(a,e,[{...k[e],ate:!1}],b[e].additionalEnergy);e.back()};return i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h3",{className:"text-xl",children:null==f?"メニュー改善":"".concat(l.NJ[f],"のメニュー改善")}),(0,r.jsx)("hr",{className:"border-amber-700"}),(0,r.jsx)("p",{children:"検索中..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h3",{className:"text-xl",children:null==f?"メニュー改善":"".concat(l.NJ[f],"のメニュー改善")}),(0,r.jsx)("hr",{className:"border-amber-700 mb-2"}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,r.jsx)("button",{className:"border-2 border-black w-40",onClick:()=>d("lowLipid"),children:"低脂質"}),(0,r.jsx)("button",{className:"border-2 border-black w-40",onClick:()=>d("healthy"),children:"ヘルシー"}),(0,r.jsx)("button",{className:"border-2 border-black w-40",onClick:()=>d("lowCarbon"),children:"低炭水化物"})]})]})}},7858:function(e,n,t){"use strict";function r(e){return JSON.parse(localStorage.getItem("eatenData")||"[]").filter(n=>n.date===e)}t.d(n,{u:function(){return r}})},2472:function(e,n,t){"use strict";function r(e,n,t,r){let a=JSON.parse(localStorage.getItem("eatenData")||"[]"),i=a.findIndex(t=>t.date===e&&t.mealKind===n);-1!==i&&a.splice(i,1),a.push({date:e,mealKind:n,additionalEnergy:r,menu:t});let l=JSON.stringify(a);return localStorage.setItem("eatenData",l),!0}t.d(n,{J:function(){return r}})},3770:function(e,n,t){"use strict";t.d(n,{Hb:function(){return s},uN:function(){return c},v$:function(){return f}});var r=t(2265),a=t(7200),i=t(6463);t(5592);var l=t(7858),u=t(7549);function o(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],[t,a]=(0,r.useState)();if(void 0!==t&&n.length==t.dependencies.length&&n.every((e,n)=>Object.is(e,t.dependencies[n])))return t.value;let i=e();return a({value:i,dependencies:n}),i}function c(){return s((0,u.i5)())}function s(e){return o(()=>(0,l.u)(e),[e])}function f(){let e=(0,i.useRouter)();return o(()=>{let n=(0,a.i)();if(null!=n)return n;throw setTimeout(()=>{e.replace("/setup/enter")},0),new Promise(()=>{})})}},5113:function(e,n,t){"use strict";function r(e){return function(e){let{sex:n,height:t,weight:r,birthday:a}=e,i=function(e){let n=new Date(e),t=new Date,r=t.getFullYear()-n.getFullYear(),a=t.getMonth()-n.getMonth();return(a<0||0===a&&t.getDate()<n.getDate())&&r--,r}(a);return"man"===n?88.362+13.397*r+4.799*t-5.677*i:447.593+9.247*r+3.098*t-4.33*i}(e)*function(e){switch(e){case 1:return 1.2;case 2:return 1.375;case 3:return 1.55;case 4:return 1.725;case 5:return 1.9;default:throw Error("Invalid exercise load")}}(e.load)}t.d(n,{Rt:function(){return r}})},9825:function(e,n,t){"use strict";t.d(n,{y:function(){return i}});var r=t(5113),a=t(8930);async function i(e,n){let t=(0,r.Rt)(n),a=await l(e,n,"breakfast"),i=await l(e,n,"lunch"),u=await l(e,n,"dinner"),o=[];return a.forEach(e=>{i.forEach(t=>{u.forEach(r=>{if(e.name!==t.name&&e.name!==r.name&&t.name!==r.name){let a=e.energy+t.energy+r.energy,i=e.price+t.price+r.price;i<=n.price&&o.push({breakfast:e,lunch:t,dinner:r,totalCalories:a,totalPrice:i})}})})}),o.sort((e,n)=>Math.abs(e.totalCalories-t)-Math.abs(n.totalCalories-t)),o}async function l(e,n,t){let i=await Promise.all(n.stores.map(n=>(0,a.D)(e,n))).then(e=>e.flatMap(e=>e)),l=(0,r.Rt)(n),u="breakfast"===t?3*n.price/10:4*n.price/10,o="breakfast"===t?3*l/10:4*l/10;return i.filter(e=>{let t=.8*o<=e.energy&&e.energy<=1.1*o,r=!e.allergens.some(e=>n.allergens.includes(e)),a=e.price<=u;return t&&r&&a})}},8930:function(e,n,t){"use strict";async function r(e,n){try{let t;if("mockMenus"in globalThis)return globalThis.mockMenus.filter(t=>t.genre===e&&t.store.includes(n));if(!(t="matsuya"==n||"sevenEleven"==n?await fetch("/api/menus/".concat(n,".json")):await fetch("/api/menus.json?genre=".concat(e,"&store=").concat(n))).ok)throw Error("Error fetching menu info: ".concat(t.statusText));let r=await t.json();for(let e of r)null==e.store&&(e.store=[n]);return r.filter(n=>n.genre===e)}catch(e){throw console.error("Failed to retrieve menu information",e),e}}t.d(n,{D:function(){return r}})},2879:function(e,n,t){"use strict";t.d(n,{$S:function(){return a},BE:function(){return i},HY:function(){return r},NJ:function(){return l}});let r={bento:"弁当",noodles:"麺類",bread:"パン",rice:"米類",sweets:"スイーツ"},a={sevenEleven:"セブンイレブン",matsuya:"松屋"},i={walnut:"くるみ",egg:"卵",shrimps:"エビ",milk:"乳",wheat:"小麦",peanut:"ピーナッツ",crab:"カニ",soba:"そば"},l={breakfast:"朝食",lunch:"昼食",dinner:"夕食",sweets:"スイーツ"}},7200:function(e,n,t){"use strict";t.d(n,{A:function(){return a},i:function(){return i}});let r="userDatabase";function a(e){!function(e){if(e.height<=0)throw Error("身長は半角数字にしてください.");if(e.weight<=0)throw Error("体重は半角数字にしてください.");if(e.load<1||e.load>5)throw Error("運動量は1から5の半角数字にしてください.");if(!Array.isArray(e.stores)||0===e.stores.length)throw Error("飲食店を選択してください.");if(!Array.isArray(e.allergens))throw Error("アレルギーを選択してください.");if(e.price<0)throw Error("価格は半角数字にしてください.")}(e),localStorage.setItem(r,JSON.stringify(e))}function i(){return function(){let e=localStorage.getItem(r);return e?JSON.parse(e):null}()}},7549:function(e,n,t){"use strict";function r(){return a(new Date)}function a(e){return"".concat(e.getFullYear(),"-").concat((e.getMonth()+1).toString(10).padStart(2,"0"),"-").concat(e.getDate().toString(10).padStart(2,"0"))}function i(e){let[n,t,r]=e.split("-").map(Number);return[n,t,r]}t.d(n,{RD:function(){return i},bW:function(){return a},i5:function(){return r}})},8260:function(e,n,t){"use strict";async function r(){await new Promise(e=>requestAnimationFrame(e)),await new Promise(e=>requestAnimationFrame(e))}t.d(n,{v:function(){return r}})},6463:function(e,n,t){"use strict";var r=t(1169);t.o(r,"useRouter")&&t.d(n,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(n,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[971,23,744],function(){return e(e.s=6715)}),_N_E=e.O()}]);