(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[951],{8027:function(e,n,t){Promise.resolve().then(t.bind(t,4930))},9645:function(e,n,t){"use strict";t.d(n,{P:function(){return c}});var r=t(7437),l=t(6463),s=t(2265);let a=[{label:"メニュー検索",onClick:e=>e.push("/menu/select-genre")},{label:"Home",onClick:e=>e.push("/home")},{label:"戻る",onClick:e=>e.back()}],i=[{label:"メニュー検索",onClick:e=>e.push("/menu/select-genre")},{label:"Home",onClick:e=>e.push("/home")},{label:"MyPage",onClick:e=>e.push("/mypage")}];function c(e){var n;let t=null!==(n=e.buttons)&&void 0!==n?n:e.isHome?i:a;return(0,r.jsxs)("div",{className:"flex flex-col w-full h-full",children:[(0,r.jsx)("main",{className:"flex flex-grow flex-shrink flex-col p-10 pt-14 overflow-y-scroll",children:(0,r.jsx)(s.Suspense,{children:e.children})}),0!=t.length&&(0,r.jsx)(o,{buttons:t,className:"flex-shrink-0"})]})}function o(e){let{className:n,buttons:t}=e,s=(0,l.useRouter)();return(0,r.jsx)("footer",{className:"w-full h-[20vw] bg-amber-600 flex flex-row ".concat(n),children:t.map(e=>{let{label:n,onClick:t}=e;return(0,r.jsx)("button",{className:"w-1 flex-grow h-full border-black border-2 border-l-0 first:border-l-2",onClick:()=>t(s),children:n},n)})})}},4930:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return h}});var r=t(7437),l=t(2265),s=t(9645),a=t(6463),i=t(2879),c=t(7549),o=t(8930);async function u(e){return(await Promise.all(e.stores.map(async n=>{let t=(await (0,o.D)("sweets",n)).filter(n=>"sweets"===n.genre&&!n.allergens.some(n=>null==e?void 0:e.allergens.includes(n)));return t[Math.floor(Math.random()*t.length)]}))).filter(e=>null!=e)}var d=t(5113),f=t(3770),m=t(2472);function h(){return(0,r.jsx)(s.P,{isHome:!0,children:(0,r.jsx)(x,{})})}function x(){var e,n,t;let s=new Date,o=(0,a.useRouter)(),h=(0,f.uN)(),x=(0,f.v$)(),j=null===(e=h.find(e=>"breakfast"===e.mealKind))||void 0===e?void 0:e.menu,v=null===(n=h.find(e=>"lunch"===e.mealKind))||void 0===n?void 0:n.menu,p=null===(t=h.find(e=>"dinner"===e.mealKind))||void 0===t?void 0:t.menu,w=(0,l.useMemo)(()=>{var e;return null===(e=h.find(e=>"sweets"===e.mealKind))||void 0===e?void 0:e.menu},[h]),N=5==s.getDay(),[k,y]=(0,l.useState)(null!=w?w:null);(0,l.useEffect)(()=>{(async()=>{if(null==w&&N){let e=await u(x);(0,m.J)((0,c.i5)(),"sweets",e.map(e=>({...e,ate:!1})),0),y(e)}})()},[x,N,w]);let S=e=>{o.push("/mypage/history/show?date=".concat((0,c.i5)(),"&when=").concat(e))},E=(0,l.useMemo)(()=>Math.floor((0,d.Rt)(x)),[x]),D=(0,l.useMemo)(()=>h.map(e=>e.menu.filter(e=>e.ate).map(e=>e.energy).reduce((e,n)=>e+n,0)+e.additionalEnergy).reduce((e,n)=>e+n,0),[h]),C=null!=j||null!=v||null!=p,M=D/E*100;return(0,r.jsxs)("div",{className:"flex justify-center items-center flex-col mb-4 gap-4",children:[(0,r.jsxs)("div",{className:"relative w-48 h-48 flex items-center justify-center",children:[(0,r.jsx)("div",{className:"absolute w-full h-full rounded-full",style:{background:"conic-gradient(orange ".concat(M,"%, lightgray ").concat(M,"% 100%)")}}),(0,r.jsxs)("div",{className:"text-center absolute",children:[(0,r.jsx)("p",{children:"摂取カロリー"}),(0,r.jsxs)("p",{children:[D,"kcal/",E,"kcal"]})]})]}),(0,r.jsx)("br",{}),N&&(0,r.jsxs)("div",{className:"flex flex-col gap-2 max-w-full",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"今週のおすすめスイーツ"}),(0,r.jsx)("div",{className:"flex bg-gray-200 p-4 rounded-md shadow-md -mx-4 justify-center flex-col sm:flex-row",children:null==k?"検索中...":0==k.length?"見つかりませんでした":k.map((e,n)=>(0,r.jsxs)("div",{className:"border-black last:border-none flex flex-col flex-shrink py-4 border-b sm:px-4 sm:border-r sm:border-b-0",children:[(0,r.jsx)("h2",{className:"font-semibold mb-2",children:i.$S[e.store[0]]}),(0,r.jsx)(g,{kind:"sevenEleven",menu:e})]},n))})]}),C?(0,r.jsxs)("div",{className:"flex gap-6 flex-col",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"本日のメニュー"}),(0,r.jsx)("div",{className:"text-center",children:(0,c.i5)()}),(0,r.jsxs)("div",{className:"container mx-auto",onClick:()=>S("breakfast"),children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"朝食"}),(0,r.jsx)(b,{kind:"breakfast",menu:j})]}),(0,r.jsxs)("div",{className:"container mx-auto",onClick:e=>S("lunch"),children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"昼食"}),(0,r.jsx)(b,{kind:"breakfast",menu:v})]}),(0,r.jsxs)("div",{className:"container mx-auto",onClick:e=>S("dinner"),children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"夕食"}),(0,r.jsx)(b,{kind:"breakfast",menu:p})]})]}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"mt-8 flex items-center justify-center",children:(0,r.jsx)("div",{className:"border border-black rounded-full py-2 px-4",children:"今日のメニューを決めましょう！"})})})]})}function g(e){let{kind:n,menu:t}=e;return null==t?(0,r.jsx)("div",{children:"見つかりませんでした"}):(0,r.jsxs)("div",{className:"flex items-start flex-col",children:[(0,r.jsx)("img",{alt:"".concat(null==t?void 0:t.name," 画像"),className:"block h-32 w-32 flex-shrink-0",src:t.image_url}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"whitespace-normal",children:t.name}),(0,r.jsxs)("p",{children:[t.price,"円"]}),(0,r.jsxs)("p",{children:[t.energy,"cal"]})]})]})}function b(e){let{kind:n,menu:t}=e;return(0,r.jsx)("div",{className:"bg-gray-200 p-4 rounded-md shadow-md",children:null==t?void 0:t.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,r.jsx)(j,{className:"flex-grow-0 flex-shrink-0",kind:n,menu:e}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-center"}),(0,r.jsx)(v,{kind:n,menu:e})]})]},t))})}function j(e){let{kind:n,menu:t,className:l}=e;return(0,r.jsx)("div",{className:l,children:null==t?(0,r.jsxs)("p",{className:"block h-32 w-32 flex-shrink-0",children:["見つかりませんでした",(0,r.jsx)("br",{}),"(バグです)"]}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("img",{alt:"".concat(t.name," 画像"),className:"block h-32 w-32 flex-shrink-0",src:t.image_url})})})}function v(e){let{kind:n,menu:t}=e;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{children:null==t?(0,r.jsxs)(r.Fragment,{children:["見つかりませんでした",(0,r.jsx)("br",{}),"(バグです)"]}):(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"",children:[(0,r.jsx)("p",{className:"text-center"}),t.name,t.energy,"kcal,",t.price,"円"]})})})})}},7858:function(e,n,t){"use strict";function r(e){return JSON.parse(localStorage.getItem("eatenData")||"[]").filter(n=>n.date===e)}t.d(n,{u:function(){return r}})},2472:function(e,n,t){"use strict";function r(e,n,t,r){let l=JSON.parse(localStorage.getItem("eatenData")||"[]"),s=l.findIndex(t=>t.date===e&&t.mealKind===n);-1!==s&&l.splice(s,1),l.push({date:e,mealKind:n,additionalEnergy:r,menu:t});let a=JSON.stringify(l);return localStorage.setItem("eatenData",a),!0}t.d(n,{J:function(){return r}})},3770:function(e,n,t){"use strict";t.d(n,{Hb:function(){return u},uN:function(){return o},v$:function(){return d}});var r=t(2265),l=t(7200),s=t(6463);t(5592);var a=t(7858),i=t(7549);function c(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],[t,l]=(0,r.useState)();if(void 0!==t&&n.length==t.dependencies.length&&n.every((e,n)=>Object.is(e,t.dependencies[n])))return t.value;let s=e();return l({value:s,dependencies:n}),s}function o(){return u((0,i.i5)())}function u(e){return c(()=>(0,a.u)(e),[e])}function d(){let e=(0,s.useRouter)();return c(()=>{let n=(0,l.i)();if(null!=n)return n;throw setTimeout(()=>{e.replace("/setup/enter")},0),new Promise(()=>{})})}},5113:function(e,n,t){"use strict";function r(e){return function(e){let{sex:n,height:t,weight:r,birthday:l}=e,s=function(e){let n=new Date(e),t=new Date,r=t.getFullYear()-n.getFullYear(),l=t.getMonth()-n.getMonth();return(l<0||0===l&&t.getDate()<n.getDate())&&r--,r}(l);return"man"===n?88.362+13.397*r+4.799*t-5.677*s:447.593+9.247*r+3.098*t-4.33*s}(e)*function(e){switch(e){case 1:return 1.2;case 2:return 1.375;case 3:return 1.55;case 4:return 1.725;case 5:return 1.9;default:throw Error("Invalid exercise load")}}(e.load)}t.d(n,{Rt:function(){return r}})},8930:function(e,n,t){"use strict";async function r(e,n){try{let t;if("mockMenus"in globalThis)return globalThis.mockMenus.filter(t=>t.genre===e&&t.store.includes(n));if(!(t="matsuya"==n||"sevenEleven"==n?await fetch("/api/menus/".concat(n,".json")):await fetch("/api/menus.json?genre=".concat(e,"&store=").concat(n))).ok)throw Error("Error fetching menu info: ".concat(t.statusText));let r=await t.json();for(let e of r)null==e.store&&(e.store=[n]);return r.filter(n=>n.genre===e)}catch(e){throw console.error("Failed to retrieve menu information",e),e}}t.d(n,{D:function(){return r}})},2879:function(e,n,t){"use strict";t.d(n,{$S:function(){return l},BE:function(){return s},HY:function(){return r},NJ:function(){return a}});let r={chinese:"中華",bento:"弁当",curry:"カレー",bread:"パン",rice:"米類",sweets:"スイーツ"},l={sevenEleven:"セブンイレブン",matsuya:"松屋"},s={walnut:"くるみ",egg:"卵",shrimps:"エビ",milk:"乳",wheat:"小麦",peanut:"ピーナッツ",crab:"カニ",soba:"そば"},a={breakfast:"朝食",lunch:"昼食",dinner:"夕食",sweets:"スイーツ"}},7200:function(e,n,t){"use strict";t.d(n,{A:function(){return l},i:function(){return s}});let r="userDatabase";function l(e){!function(e){if(e.height<=0)throw Error("身長は半角数字にしてください.");if(e.weight<=0)throw Error("体重は半角数字にしてください.");if(e.load<1||e.load>5)throw Error("運動量は1から5の半角数字にしてください.");if(!Array.isArray(e.stores)||0===e.stores.length)throw Error("飲食店を選択してください.");if(!Array.isArray(e.allergens))throw Error("アレルギーを選択してください.");if(e.price<0)throw Error("価格は半角数字にしてください.")}(e),localStorage.setItem(r,JSON.stringify(e))}function s(){return function(){let e=localStorage.getItem(r);return e?JSON.parse(e):null}()}},7549:function(e,n,t){"use strict";function r(){return l(new Date)}function l(e){return"".concat(e.getFullYear(),"-").concat((e.getMonth()+1).toString(10).padStart(2,"0"),"-").concat(e.getDate().toString(10).padStart(2,"0"))}function s(e){let[n,t,r]=e.split("-").map(Number);return[n,t,r]}t.d(n,{RD:function(){return s},bW:function(){return l},i5:function(){return r}})},6463:function(e,n,t){"use strict";var r=t(1169);t.o(r,"useRouter")&&t.d(n,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(n,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[971,23,744],function(){return e(e.s=8027)}),_N_E=e.O()}]);